---
import SectionTitle from "./SectionTitle.astro";
const TIMESTAMP_END = 1761264420000;

---

<section class="w-full !min-h-[650px] my-32 flex flex-col gap-y-10 justify-center items-center">
  <SectionTitle title="Cuenta regresiva para el Evento..." />

  <div class="w-mfull gap-x-2 flex flex-row" data-date={TIMESTAMP_END}>
    <div class="boxer-date">
      <span class="text-5xl font-normal text-center" data-days></span>
      <span class="text-[9px] text-center">DÃ­as</span>
    </div>

    <div class="boxer-date">
      <span class="text-5xl font-normal text-center" data-hours></span>
      <span class="text-[9px] text-center">Horas</span>
    </div>

    <div class="boxer-date">
      <span class="text-5xl font-normal text-center" data-minutes></span>
      <span class="text-[9px] text-center">Minutos</span>
    </div>
    <div class="boxer-date">
      <span class="text-5xl font-normal text-center" data-seconds></span>
      <span class="text-[9px] text-center">Segundos</span>
    </div>
  </div>

  <span aria-hidden="true" class="mt-1 text-xl italic"
    >...para mi cumpleaÃ±os ðŸ¥³ðŸ¥³ðŸ¥³</span
  >
</section>

<script>
  const SECOND = 1000;
  const MINUTE = SECOND * 60;
  const HOUR = MINUTE * 60;
  const DAY = HOUR * 24;

  export function init() {
    const $countdown = document.querySelector("[data-date]");
    if (!$countdown) return;

    const $days = document.querySelector("[data-days]");
    const $hours = document.querySelector("[data-hours]");
    const $minutes = document.querySelector("[data-minutes]");
    const $seconds = document.querySelector("[data-seconds]");

    const timestamp = $countdown.getAttribute("data-date");
    if (!timestamp) return;

    const date = new Date(+timestamp).getTime();

    function updateCountdown() {
      const now = Date.now();

      const diff = date - now;

      if ($days instanceof HTMLElement) {
        $days.innerText = Math.floor(diff / DAY).toString();
      }
      if ($hours instanceof HTMLElement) {
        $hours.innerText = Math.floor((diff % DAY) / HOUR).toString();
      }
      if ($minutes instanceof HTMLElement) {
        $minutes.innerText = Math.floor((diff % HOUR) / MINUTE).toString();
      }
      if ($seconds instanceof HTMLElement) {
        $seconds.innerText = Math.floor((diff % MINUTE) / SECOND).toString();
      }
    }

    setInterval(updateCountdown, SECOND);
  }
  init(); // llamado a la funciÃ³n para iniciar el contador
</script>

<style is:inline>
  .boxer-date {
    background-color: var(--color-theme-dark-date);
    color: var(--color-theme-seashell);
    border-radius: 3px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    transition: background-color 0.3s ease;
    width: 5rem;
    height: 4.5rem;
    transform: skew(-0.03turn);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 2px;
  }
</style>
